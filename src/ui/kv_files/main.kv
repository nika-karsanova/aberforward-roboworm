<WindowManager>:
    SetupWindow:
        id: setup_window
    LocalFileManagerWindow:
        id: local_file_manager_window
    RemoteFileManagerWindow:
        id: remote_file_manager_window
    ResultsWindow:
        id: results_window

<SetupWindow>
    name: "setup"

    GridLayout:
        cols: 3
        size: root.width, root.height
        spacing: 10
        padding: 100

        Button:
            text: "Connect to the MySQL database"
            size_hint: (0.3, 0.3)
            on_release: app.root.current = "remote"

        Button:
            text: "Connect to local storage"
            size_hint: (0.3, 0.3)
            on_release: app.root.current = "local"

<LocalFileManagerWindow>
    name: "local"

<RemoteFileManagerWindow>
    name: "remote"

<ResultsWindow>
    name: "results"

    GridLayout:
        cols: 1
        rows: 3
        size: root.width, root.height
        padding: 10
        spacing: 10

        Image:
            id: output_img
            source: ""

        GridLayout:
            cols: 5
            rows: 1
            size_hint: (None, None)
            size: root.width, 30

            Button:
                text: "Back"
                on_release:
                    app.root.current = "local"
                    root.manager.transition.direction = "right"


            Button:
                text: "Export"

# general purpose widgets
<LocalWindowLayout>
    id: local_window_layout

    GridLayout:
        cols: 1
        rows: 5
        size: root.width, root.height
        padding: 10
        spacing: 10

        Label:
            id: local_window_label
            text: "Placeholder Text"
            size_hint: (0.1, 0.1)

        Carousel:
            id: local_window_carousel
            direction: "right"
            on_current_slide: local_window_layout.fetch_filename(self.index)

        FileChooserIconView:
            id: local_filechooser
#            dirselect: True
            path: local_window_layout.get_default_path()
            on_selection: local_window_layout.selected(self.selection)

        GridLayout:
            id: local_navbar
            cols: 10
            rows: 1
            size_hint: (None, None)
            size: root.width, 30

            Button:
                text: "Merge (grid)"
                on_press:
                    local_window_layout.action_handler(self.text)
#                    app.root.ids.results_window.ids.output_img.source = local_window_layout.get_output_img()
#                on_release: app.root.current = "results"

            Button:
                text: "Merge (strip)"
                on_press:
                    local_window_layout.action_handler(self.text)
#                on_release:
#                    app.root.ids.results_window.ids.output_img.texture = local_window_layout.get_output_img()
#                    app.root.current = "results"

            Button:
                text: "Merge (animation)"
                on_press:
                    local_window_layout.action_handler(self.text)
#                    app.root.ids.results_window.ids.output_img.source = local_window_layout.get_output_img()
#                on_release: app.root.current = "results"


